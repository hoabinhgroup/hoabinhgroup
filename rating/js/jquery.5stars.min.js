function checkRatingTooltipClass(a){if("undefined"==typeof ratingtoolclasses[a]){var b=document.styleSheets;for(var c in b){var d=b[c].rules||b[c].cssRules;for(var e in d)if("undefined"!=typeof d[e].selectorText&&d[e].selectorText.indexOf(a)>=0)return ratingtoolclasses[a]=!0,!0}ratingtoolclasses[a]=!1}return ratingtoolclasses[a]}!function(a){function b(b,d){var g,u,v,F,f=jQuery.extend({},{php:"",id:"",property:"",title:"",displaymode:!1,rewrite:!1,haschild:!1,showmean:!0,delayed:!1,debug:!1,skin:"skins/skin.png",stars:5,step:1,round:!0,decimals:1,cursor:"pointer",load:!0,enable:!0,animate:!1,easing:5,showtext:!0,tooltip:!0,tooltiphtml:"",tooltipclass:"rating-tooltip",tooltipeasing:2.5,textlocation:"bottom",minvotes:0,textstart:"rate to see statistics",textloading:"...loading",textminvotes:"%r votes required",textmain:"%ms / %maxs (from %v votes)",texthover:"very bad|bad|average|good|perfect",textthanks:"thank you",textdelay:1500,ondata:function(){},onmove:function(){},onlieve:function(){},onclick:function(){}},d),h=new Array,i=-1,j=-2,k=0,l=0,m=0,o="stars_"+Math.floor(1e4*Math.random())+"_"+(new Date).getTime()+"_"+Math.floor(1e4*Math.random()),p=-1,q=0,r=0,s=0,t=0,w=!1,x=!1,y=!0,z=!1,A=!1,B="",C=0,D="",E=Math.pow(10,f.decimals),G=!1,H=0,I=0,J=null,K=null,L=!1,M=function(){window.console&&f.debug&&console.log(arguments)},N=function(){J="ontouchstart"in document.documentElement,K=!(/Mobile/i.test(navigator.userAgent)&&!/ipad/i.test(navigator.userAgent)),va(),ha(),X(),$(),P(),O()},O=function(){J&&!K?"mobile"==f.tooltip?f.tooltip=!0:"desktop"==f.tooltip&&(f.tooltip=!1):"desktop"==f.tooltip?f.tooltip=!0:"mobile"==f.tooltip&&(f.tooltip=!1),f.tooltip===!0&&(checkRatingTooltipClass(f.tooltipclass)||(f.tooltip=!1))},P=function(){if(M("connect",arguments),f.displaymode)return f.enable=!1,y=!1,$(),void S(t+"|"+r+"|99999|",!1);if(1!=arguments[0]&&1!=f.load)return void Y(f.textstart);if(""==f.id)return w=!0,void X();if(""==f.php){if(R()){if(arguments[0])r=Math.min(Math.max(s,0),100),localStorage.setItem(f.id.concat("::",f.property),r),t=1,f.rewrite===!1&&(W(),z=!0);else{var a=localStorage.getItem(f.id.concat("::",f.property));a?(r="string"==typeof a?sa(a):a,t=1,f.rewrite===!1&&(W(),z=!0)):(r=0,t=0)}return void S(t+"|"+r+"|"+(arguments[0]?f.textdelay/1e3:0)+"|",!!arguments[0])}return w=!0,void X()}f.delayed!==!1&&1==arguments[0]||""==f.php||f.haschild&&!f.showmean||Q(arguments[0])},Q=function(){W();var b=!1;c="";var c=c.concat("id=",encodeURIComponent(f.id));if(""!=f.property&&(c=c.concat("&p=",encodeURIComponent(f.property))),f.rewrite===!0&&(c=c.concat("&rw=1")),f.showmean===!1&&(c=c.concat("&u=1")),arguments[0]){w=!1,""!=f.title&&(c=c.concat("&i=",encodeURIComponent(f.title))),c=c.concat("&r=",Math.min(Math.max(s,0),100),"&ref=",encodeURIComponent(document.URL)),b=!0;var d=f.id.replace(/['"\s]/g,"_").replace(/[^a-z0-9_]/gi,""),e=a(".rating_system_class_id_"+d).first(),g=e.rating("option","title");"undefined"!=typeof g&&""!=g||(g=e.rating("id")),c=c.concat("&pt=",encodeURIComponent(g))}a.ajax({type:b?"POST":"GET",url:f.php,dataType:"text",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:c,cache:!1,done:function(a){S(a,b)},fail:function(a,b,c){Y("PHP problem | "+f.php+" | "+c,f.debug),W()},success:function(a){S(a,b)},error:function(a,b,c){Y("PHP problem | "+f.php+" | "+c,f.debug),W()}})},R=function(){try{return"object"==typeof window.localStorage}catch(a){return!1}},S=function(d,e){M("parse",arguments),W();var g=d.split("|");if(""!=g[4]&&"undefined"!=typeof g[4])Y("Error: "+g[4],f.debug),"function"==typeof f.ondata&&f.ondata({id:f.id,value:r,votes:t,error:g[3]},b);else{if(w=!0,t=parseInt(g[0]),r=parseFloat(g[1]),0==t&&0==r&&R()&&localStorage.removeItem(f.id.concat("::",f.property)),ia(),h[1].target=t>=f.minvotes?pa(r):0,f.animate||(h[1].value=h[1].target),e&&f.textdelay>0?setTimeout(ha,f.textdelay):ha(),X(e),y){if(z===!1){g[2]=parseInt(g[2]);var i=g[2]>500?5e5:Math.max(0,1e3*g[2]);e&&f.textdelay>0&&(i=Math.max(i,f.textdelay)),i>0?setTimeout(V,i):V()}if(e&&""!=f.property){if(""!=g[3]&&"undefined"!=typeof g[3]||""==f.php){var j=g[3].split(";");j[0]=parseInt(j[0]),j[1]=parseFloat(j[1]);var k=f.id.replace(/['"\s]/g,"_").replace(/[^a-z0-9_]/gi,"");a(".rating_system_class_id_"+k).each(function(){var b=a(this);b[c]("option","showmean")===!1?b[c]("getsumofchildren"):b[c]("votes")<j[0]+(f.rewrite?1:0)?(b[c]("votes",j[0]),b[c]("value",j[1]),b[c]("option","enable",!1)):b[c]("reload")})}}else if(!e&&""!=f.property){var k=f.id.replace(/['"\s]/g,"_").replace(/[^a-z0-9_]/gi,"");a(".rating_system_class_id_"+k).each(function(){var b=a(this);b[c]("option","showmean")===!1&&b[c]("getsumofchildren")})}}"function"==typeof f.ondata&&f.ondata({id:f.id,value:r,votes:t,error:""},b)}},U=function(){x=!1,X()},V=function(){f.enable=!0,$(),M("enabled")},W=function(){f.enable=!1,$(),M("disable")},X=function(a){var b;x&&f.textdelay>0?(b=f.textthanks,setTimeout(U,f.textdelay)):b=w?f.minvotes>t?f.textminvotes:f.textmain:f.load?f.textloading:f.textstart,Y(b,!0,a)},Y=function(a){if((f.showtext||f.tooltip)&&arguments[1]!==!1&&(a=""==a.replace(/^\s+|\s+$/gm,"")?"&nbsp;":Z(a),M("text",a),A))if(f.tooltip===!0&&1==arguments.length){if(""!=f.tooltiphtml){var b=Z(f.tooltiphtml);a=b.replace(/%text/gi,a)}F.children("div").html(a)}else f.showtext===!0&&u.html(a)},Z=function(a){return"string"!=typeof a?a:(a=a.replace(/%v/gi,t),a=a.replace(/%ms/gi,Math.round(qa(r)*E)/E),a=a.replace(/%ps/gi,Math.round(qa(s)*E)/E),a=a.replace(/%maxs/gi,f.stars),a=a.replace(/%m/gi,Math.round(pa(r))),a=a.replace(/%p/gi,Math.round(pa(s))),a=a.replace(/%rr/gi,f.minvotes-t),a=a.replace(/%r/gi,f.minvotes),a=a.replace(/%i/gi,C))},$=function(){M("initControls: "+f.enable),J&&!K||(a("#"+o).unbind("mouseover mousemove mousedown mouseup mouseleave",ba),1==f.enable&&a("#"+o).bind("mouseover mousemove mousedown mouseup mouseleave",ba),a("#"+o).css("cursor",f.enable?f.cursor:"auto")),J&&(a("#"+o).unbind("touchstart touchend touchmove",ba),1==f.enable&&a("#"+o).bind("touchstart touchend touchmove",ba))},aa=function(b){var c=a("html").scrollLeft();if(c||(c=a("body").scrollLeft()),!J||"touchstart"!=b.type&&"touchend"!=b.type&&"touchmove"!=b.type)var e=b.clientX;else{"touchstart"!=b.type&&b.preventDefault();var d=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0],e=d.pageX}return e=e+c-a("#"+o).offset().left+1e-4,e>k?e=k:e<1&&(e=1),e=na(e)},ba=function(c){switch(c=c?c:window.event,c.type){case"mouseover":a("#"+o).unbind("mouseover",ba),ia(),la(1,0,!1,!0);case"touchstart":"touchstart"==c.type&&a("#"+o).unbind("touchstart",ba);var d=aa(c),e=100*d/k;s=Math.round(e*E)/E,H=d,I=d,ca(d),fa(!0),da(d),"touchstart"==c.type&&(L=!0,ea());break;case"mousemove":case"touchmove":var d=aa(c);if(d>0){var e=100*d/k;s=Math.round(e*E)/E,I=d,f.tooltip?ja(!0):ca(d),la(1,0,!1,!0),la(2,d,!1),p!=e&&"function"==typeof f.onmove&&(p=e,f.onmove(e,b))}else ja(!0);break;case"mousedown":L=!0,ea();break;case"touchend":a("#"+o).bind("touchstart",ba);case"mouseup":if("mouseup"==c.type&&a("#"+o).bind("mouseover",ba),fa(!1),L===!1)return;W(),ea(),x=!0,q=p,D=B,f.delayed===!1?(X(),p=-1):V(),P(!0),"function"==typeof f.onclick&&f.onclick(s,b);break;case"mouseout":case"onmouseout":a("#"+o).bind("mouseover",ba);var g=c.relatedTarget||c.toElement;if(g&&"HTML"!=g.nodeName)return;case"mouseleave":a("#"+o).unbind("mouseover",ba),a("#"+o).bind("mouseover",ba),L=!1,fa(!1),1!=f.delayed?(h[1].target=f.minvotes>t?0:pa(r),X()):x?(h[1].target=f.minvotes>t?0:pa(q),Y(D)):X();var e;f.animate?(h[1].value=s,e=s):(h[1].value=h[1].target,e=r),f.delayed===!1&&(p=-1),la(2,0,!1,!0),ma(1,f.minvotes>t?0:e,f.step>0&&f.round),ha(),"function"==typeof f.onlieve&&f.onlieve(b)}},ca=function(a){if(f.showtext||f.tooltip){var b=v.length;if(b>=1){var c=H>a&&f.tooltipeasing>0?Math.floor(a*b/k)-1:Math.ceil(a*b/k)-1;c=c<0?0:c>b-1?b-1:c,C=c+1,Y(v[c]),B=v[c]}}},da=function(c){if(f.tooltip){H=c;var d=F.children("div"),e=d.outerWidth(!0)+l*f.step,g=d.outerHeight(!0)+9;f.showtext&&"top"==f.textlocation&&(g-=u.outerHeight(!0)),F.css("top",-Math.round(g)).css("left",Math.floor(c-e/2)+a("#"+o).offset().left-b.offset().left).width(0)}},ea=function(){h[1].target=f.minvotes>t?0:r,h[1].value=s,la(2,0,!1,!0),ma(1,s,f.step>0&&f.round)},fa=function(a){a?f.tooltip===!0&&G===!1&&(b.prepend(F),G=!0):G===!0&&(ja(!1),F.remove(),G=!1)},ga=function(){for(var a,b=0,c=1;c<2;c++)a=h[c].target-h[c].value,0==a?b++:Math.abs(a)<1?h[c].value+=a:f.easing<=0?h[c].value+=a:h[c].value+=a/(1+f.easing),ma(c,h[c].value,f.step>0&&f.round);1==b&&ia()},ha=function(){i==-1&&(ma(1,h[1].value,f.step>0&&f.round),i=setInterval(ga,20))},ia=function(){clearInterval(i),i=-1},ja=function(a){f.tooltip&&(a?j==-2&&(j=setInterval(ka,20)):(clearInterval(j),j=-2))},ka=function(){var a=I-H;Math.abs(a)<1?ja(!1):f.tooltipeasing>0&&(a/=1+f.tooltipeasing),ca(H+a),da(H+a)},la=function(a,b,c,d){1==c&&(b=oa(b)),b=Math.min(Math.round(b),k*f.stars),g[a].style.width=b+"px",a>0&&!d&&(g[0].style.backgroundPosition=-b+"px 0",g[0].style.left=b+"px",g[0].style.width=k-b+"px")},ma=function(a,b,c){b=Math.round(k*b/100),la(a,b,c)},na=function(a){return f.step>0?Math.ceil(a/(l*f.step))*(l*f.step):a},oa=function(a){return f.step>0?Math.round(a/(l*f.step))*(l*f.step):a},pa=function(a){return f.round?100*oa(a*k/100)/k:a},qa=function(a){return f.step>0&&f.round?Math.round(a*k/(100*l*f.step))*f.step:a*k/(100*l)},ra=function(){if(""==f.id){var a=b.attr("id");void 0!=a&&(f.id=a)}var c;for(var d in f)f.hasOwnProperty(d)&&"function"!=typeof f[d]&&(c=b.data(d),"undefined"!=typeof c&&("string"==typeof c?(c=c.replace("/\t\n\r/i",""),c=c.replace(/^\s+|\s+$/g,""),"id"==d||"title"==d?f[d]=c:f[d]=sa(c)):f[d]=c,ta(d)));if(c=b.data("value"),"undefined"!=typeof c&&""!=c&&(r=parseFloat(c),r=r<0?0:r>100?100:r),c=b.data("votes"),"undefined"!=typeof c&&""!=c&&(t=parseInt(c),t=t<0?0:t),c=b.data("settings"),"undefined"!=typeof c&&""!=c){c=c.replace("/\t\n\r/i","");for(var e=c.split(";"),g=0;g<e.length;g++){var h=e[g].split(":");h[0]=h[0].replace(/\s/g,""),"undefined"!=typeof f[h[0]]&&h.length>=2&&(h[1]=h[1].replace(/^\s+|\s+$/g,""),f[h[0]]=sa(h[1]),ta(h[0]))}}ta("enable"),ta("haschild"),ta("texthover")},sa=function(a){var b=a.toLowerCase();return b!=String("false")&&b!=String("no")&&(b==String("true")||b==String("yes")||(0==isNaN(parseFloat(a))?parseFloat(a):a))},ta=function(a){switch(a){case"id":f.id=String(f.id);break;case"easing":f.easing<0&&(f.easing=0);break;case"step":f.step<0&&(f.step=0);break;case"stars":f.stars<0&&(f.stars=0);break;case"minvotes":f.minvotes<0&&(f.minvotes=0);break;case"decimals":f.decimals<0&&(f.decimals=0),E=Math.pow(10,f.decimals);break;case"textdelay":f.textdelay<0&&(f.textdelay=0);break;case"texthover":"string"==typeof f.texthover?v=f.texthover.split("|"):(v=[],v[0]=f.texthover.toString());break;case"haschild":f.haschild&&(f.enable=!1,y=!1,""==f.php&&(f.showmean=!1));break;case"enable":y=f.enable}},ua=function(c){A=!1;var e=(a('<img "/>'),f.skin.split("|")[0]),g=new Image;g.onload=function(){l=this.width,m=this.height,0!=l&&0!=m||!f.debug?c?(va(!0),X(),ha(),$()):N():(u=a('<div class="rating-text" style="z-index:3;">detected skin '+e+" size "+l+"x"+m+" please check the path to skin file.</div>"),b.empty(),b.append(u))},g.onerror=function(){f.debug&&(u=a('<div class="rating-text" style="z-index:3;">cannot load skin '+e+". Please check the path to skin file.</div>"),b.empty(),b.append(u))},g.src=e},va=function(c){var d=f.skin.split("|"),e=1==d.length,i=parseInt(m/(e?3:1));if(k=f.stars*l,""==f.property){var j=f.id.replace(/['"\s]/g,"_").replace(/[^a-z0-9_]/gi,"");b.addClass("rating_system_class_id_"+j)}var n=b.css("position");"static"==n&&b.css("position","relative"),d[0]=d[0].replace(/^\s+|\s+$/g,""),d[1]=d.length<2?d[0]:d[1].replace(/^\s+|\s+$/g,""),d[2]=d.length<3?d[1]:d[2].replace(/^\s+|\s+$/g,"");var p="position:absolute;top:0px;left:0px;padding:0;margin:0;background:",q='<div id="'+o+'" style="display:block;position:relative;overflow:hidden;width:'+k+"px;height:"+i+'px;top:0px;left:0px;">';if(q+='<div style="'+p+"url("+d[0]+") repeat-x;width:"+k+"px;height:"+i+'px;z-index:0;"></div>',q+='<div style="'+p+"url("+d[1]+") 0px "+(e?-i:0)+"px repeat-x;width:0px;height:"+i+'px;z-index:1;"></div>',q+='<div style="'+p+"url("+d[2]+") 0px "+(e?2*-i:0)+"px repeat-x;width:0px;height:"+i+'px;z-index:2;"></div>',q+="</div>",F=a('<div class="'+f.tooltipclass+'" style="position:relative; z-index:9999;"><div style="position: absolute;"></div></div>'),u=a('<div class="rating-text" style="z-index:3;"></div>'),"top"!=f.textlocation&&"bottom"!=f.textlocation){var s;s=a("_id"==f.textlocation?"#_"+f.id:"#"+f.textlocation),1==s.length?u=s:f.textlocation="bottom"}b.empty(),"top"==f.textlocation?b.append(u,q):"bottom"==f.textlocation?b.append(q,u):b.append(q),g=a("#"+o).children("div"),"top"==f.textlocation||"bottom"==f.textlocation;var v=f.minvotes<=t||r>0&&!A?r:0;1==c?h[1]={value:v,target:v}:h[1]={value:f.animate?0:v,target:v},0==f.stars&&(b.css("height","0px"),k=1),"static"==n&&b.css("position","static"),A=!0},wa=function(){ia(),r=0,s=0,t=0,w=!1,x=!1,P()};this.option=function(c,d){if("undefined"!=typeof c){if(c=c.replace(/^\s+|\s+$/g,""),"undefined"==typeof f[c])return b;if("undefined"==typeof d)return f[c];if("string"==typeof d?(d=d.replace(/^\s+|\s+$/g,"").toLowerCase(),f[c]=sa(d)):"boolean"==typeof d?f[c]=d:"number"==typeof d&&(f[c]=d),ta(c),"enable"==c&&A)$();else if("cursor"==c&&A)a("#"+o).css("cursor",f.enable?f.cursor:"auto");else if("id"==c)wa();else if("showmean"==c)wa();else if("tooltip"==c)O();else if("showtext"==c&&A)f.showtext?X():u.html("");else if("skin"==c)ua(!0);else if(!A||"round"!=c&&"step"!=c)if("decimals"==c&&A)X();else if("textlocation"==c&&A)if("top"==f.textlocation)u.prependTo(b);else if("bottom"==f.textlocation)u.appendTo(b);else{var e=a("#"+f.textlocation);1==e.length&&u.appendTo(e)}else if("stars"==c&&A){k=f.stars*l,a("#"+o)[0].style.width=k+"px",X();var g=h[1].value;h[1].value=0,ha(),h[1].value=g}else"load"==c&&A?(w=!1,X()):1==f.showtext&&A&&"text"==c.substr(0,4)&&X();else h[1].target=t>=f.minvotes?pa(r):0,f.animate||(h[1].value=h[1].target),X(),ha();return b}},this.value=function(a){return"undefined"==typeof a?r:(a=a<0?0:a>100?100:a,h[1]={target:a,value:r},r=a,X(),1==arguments[1]&&(h[1].value=a),A&&ha(),b)},this.votes=function(a){return"undefined"==typeof a?t:(a=a<0?0:a,t=a,X(),b)},this.id=function(a){return"undefined"==typeof a?f.id:(f.id=String(a),wa(),b)},this.reload=function(){return wa(),b},this.getsumofchildren=function(){if(""!=f.haschild){var d=a('*[data-id="'+f.id+'"]').not(b),e=0,g=0;d.each(function(){var b=a(this);"undefined"!=typeof b.data(c)&&(e+=b[c]("value"),g++)}),e/=g,t=0==g||0==e?0:1,w=!0,b[c]("value",e),""==f.php&&f.haschild!==!1&&R()&&localStorage.setItem(f.id.concat("::",f.property),e)}return b},this.submit=function(){return f.delayed===!0&&h[1].value>0&&y===!0&&f.haschild===!1&&s>0&&q>0&&(s=h[1].value,x=!0,p=-1,q=0,""!=f.php&&Q(!0),s=0),b},ra(),ua(!1)}var c="rating",d="rating_submit";a.fn[d]=function(){if(0==this.length)return!1;var b=-1,d=0,e=50;this.each(function(){var f=a(this),g=f[c]("id");b!=g?(b=g,d=0,f[c]("submit")):(d+=e,setTimeout(function(){f[c]("submit")},d))})},a.fn[c]=function(d){if(0==this.length)return!1;var e=arguments[0];if("string"==typeof e){var f=Array.prototype.slice.call(arguments,1);if("submit"==e)return this.each(function(){var b=a(this),e=b.data(c);if("function"==typeof e[d])return e[d].apply(b[0],f)});var g=a(this),h=g.data(c);if("function"==typeof h[d])return h[d].apply(g[0],f)}else if("object"==typeof d||!d)return this.each(function(){var e=a(this);if("object"==typeof d||!d)return e.data(c,new b(e,d))})}}(jQuery);var ratingtoolclasses={};